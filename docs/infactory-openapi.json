{"openapi":"3.1.0","info":{"title":"Archive Intelligence API","description":"Semantic search and RAG API for The Atlantic Archive","version":"1.0.0"},"paths":{"/v1/health":{"get":{"tags":["Health"],"summary":"Health Check","description":"Check API health status.","operationId":"health_check_v1_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponseEnvelope_HealthData_"}}}}}}},"/v1/health/detailed":{"get":{"tags":["Health"],"summary":"Detailed Health Check","description":"Detailed health check including all services.","operationId":"detailed_health_check_v1_health_detailed_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Detailed Health Check V1 Health Detailed Get"}}}}}}},"/v1/keys/create":{"post":{"tags":["API Keys"],"summary":"Create Api Key Endpoint","description":"Create a new API key for a user.\n\n- **email**: Email address for the API key registration\n\nReturns the API key. **Save it immediately** â€” it cannot be recovered after this response.","operationId":"create_api_key_endpoint_v1_keys_create_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateKeyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Create Api Key Endpoint V1 Keys Create Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/topics":{"get":{"tags":["Reference"],"summary":"Get Topics","description":"Get available topics (limited to max_response_rows).","operationId":"get_topics_v1_topics_get","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Topics V1 Topics Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/authors":{"get":{"tags":["Reference"],"summary":"Get Authors","description":"Get available authors (limited to max_response_rows).","operationId":"get_authors_v1_authors_get","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Authors V1 Authors Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/sections":{"get":{"tags":["Reference"],"summary":"Get Sections","description":"Get available sections (limited to max_response_rows).","operationId":"get_sections_v1_sections_get","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Sections V1 Sections Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/search":{"post":{"tags":["Search"],"summary":"Search","description":"Perform search over the archive with multiple search modes.\n\n- **query**: Search query (1-500 characters)\n- **top_k**: Number of results to return (1-20)\n- **mode**: Search mode - 'semantic' (vector), 'keyword' (full-text), or 'hybrid' (combined, default)\n- **rerank**: Re-rank results using a cross-encoder for improved relevance\n- **dedupe**: Deduplicate results by article (default: true)\n- **filters**: Optional filters for topics, authors, sections, date range\n- **group_by**: Optional grouping by topic, author, year, or section\n- **include**: Options for including chunk excerpts and embeddings\n\n## Search Modes\n\n- **semantic**: Uses vector embeddings to find conceptually similar content. \n  Best for: natural language queries, finding related topics, concept search.\n\n- **keyword**: Uses PostgreSQL full-text search to find exact word matches.\n  Best for: specific terms, names, quotes, exact phrases.\n\n- **hybrid**: Combines both approaches using Reciprocal Rank Fusion (RRF).\n  Best for: general queries where you want both exact matches and related content.\n\n## Re-ranking\n\nWhen `rerank=true`, results are re-scored using a cross-encoder model (Cohere/Jina)\nthat considers query and document together for deeper relevance understanding.\nThis adds ~100-300ms latency but can significantly improve result quality.","operationId":"search_v1_search_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SearchRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Search V1 Search Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/articles/{article_id}":{"get":{"tags":["Retrieve"],"summary":"Get Article","description":"Retrieve article metadata by ID.\n\nNote: This endpoint returns metadata only, not full article content.","operationId":"get_article_v1_articles__article_id__get","parameters":[{"name":"article_id","in":"path","required":true,"schema":{"type":"string","title":"Article Id"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Article V1 Articles  Article Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/chunks/{chunk_id}":{"get":{"tags":["Retrieve"],"summary":"Get Chunk","description":"Retrieve a chunk excerpt by ID.\n\nNote: Returns only the public excerpt (capped at MAX_EXCERPT_CHARS),\nnot the full chunk text.","operationId":"get_chunk_v1_chunks__chunk_id__get","parameters":[{"name":"chunk_id","in":"path","required":true,"schema":{"type":"string","title":"Chunk Id"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Chunk V1 Chunks  Chunk Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/articles/{article_id}/content":{"get":{"tags":["Retrieve"],"summary":"Get Article Content","description":"Retrieve full article content by ID.\n\nReturns the article metadata along with the full text content.\nUses the stored full_content if available, otherwise reconstructs from chunks.","operationId":"get_article_content_v1_articles__article_id__content_get","parameters":[{"name":"article_id","in":"path","required":true,"schema":{"type":"string","title":"Article Id"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Article Content V1 Articles  Article Id  Content Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/summarize":{"post":{"tags":["Summarize"],"summary":"Summarize","description":"Generate a summary based on retrieved archive content.\n\n- **query**: Question or topic to summarize\n- **retrieval**: Configuration for retrieving relevant chunks\n- **style**: Output style (format and length)\n\nReturns a summary with citations to source chunks.","operationId":"summarize_v1_summarize_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SummarizeRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Summarize V1 Summarize Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/answer":{"post":{"tags":["Summarize"],"summary":"Answer","description":"Answer a question based on retrieved archive content.\n\nSimilar to summarize, but includes suggested follow-up questions.","operationId":"answer_v1_answer_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnswerRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Answer V1 Answer Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/embeddings/manifest":{"get":{"tags":["Embeddings"],"summary":"Get Embeddings Manifest","description":"Get metadata about available embedding datasets.\n\nReturns information about pre-computed embeddings stored in Qdrant\nthat can be fetched via the bulk endpoint.","operationId":"get_embeddings_manifest_v1_embeddings_manifest_get","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Embeddings Manifest V1 Embeddings Manifest Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/embeddings/get":{"post":{"tags":["Embeddings"],"summary":"Get Embeddings","description":"Fetch embeddings for specific chunk IDs from Qdrant.\n\n- **chunk_ids**: List of chunk IDs (max 200)\n- **include_metadata**: Include article metadata with each embedding\n\nReturns embeddings and optionally metadata for the requested chunks.","operationId":"get_embeddings_v1_embeddings_get_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EmbeddingsGetRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Embeddings V1 Embeddings Get Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/limits":{"get":{"tags":["Limits"],"summary":"Get Limits","description":"Get current rate limits and usage caps.\n\nReturns the limits applied to API requests for the current API key.","operationId":"get_limits_v1_limits_get","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Limits V1 Limits Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AnswerRequest":{"properties":{"query":{"type":"string","maxLength":500,"minLength":1,"title":"Query"},"retrieval":{"$ref":"#/components/schemas/RetrievalConfig"}},"type":"object","required":["query"],"title":"AnswerRequest","description":"Answer request body."},"CreateKeyRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"}},"type":"object","required":["email"],"title":"CreateKeyRequest","description":"Request to create a new API key."},"EmbeddingsGetRequest":{"properties":{"chunk_ids":{"items":{"type":"string"},"type":"array","maxItems":200,"title":"Chunk Ids"},"include_metadata":{"type":"boolean","title":"Include Metadata","default":true}},"type":"object","required":["chunk_ids"],"title":"EmbeddingsGetRequest","description":"Request body for bulk embedding fetch."},"ErrorCode":{"type":"string","enum":["invalid_key","rate_limited","bad_request","not_found","server_error"],"title":"ErrorCode","description":"Standard error codes for API responses."},"ErrorDetail":{"properties":{"code":{"$ref":"#/components/schemas/ErrorCode"},"message":{"type":"string","title":"Message"},"details":{"additionalProperties":true,"type":"object","title":"Details"}},"type":"object","required":["code","message"],"title":"ErrorDetail","description":"Error detail structure."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthData":{"properties":{"status":{"type":"string","title":"Status","default":"ok"},"version":{"type":"string","title":"Version"}},"type":"object","required":["version"],"title":"HealthData","description":"Health check response data."},"ResponseEnvelope_HealthData_":{"properties":{"request_id":{"type":"string","title":"Request Id"},"data":{"anyOf":[{"$ref":"#/components/schemas/HealthData"},{"type":"null"}]},"error":{"anyOf":[{"$ref":"#/components/schemas/ErrorDetail"},{"type":"null"}]}},"type":"object","required":["request_id"],"title":"ResponseEnvelope[HealthData]"},"RetrievalConfig":{"properties":{"top_k":{"type":"integer","maximum":20.0,"minimum":1.0,"title":"Top K","default":12},"filters":{"$ref":"#/components/schemas/SearchFilters"}},"type":"object","title":"RetrievalConfig","description":"Configuration for retrieval in summarize/answer."},"SearchFilters":{"properties":{"topics":{"items":{"type":"string"},"type":"array","title":"Topics"},"authors":{"items":{"type":"string"},"type":"array","title":"Authors"},"sections":{"items":{"type":"string"},"type":"array","title":"Sections"},"date_from":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date From"},"date_to":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date To"}},"type":"object","title":"SearchFilters","description":"Filters for search queries."},"SearchInclude":{"properties":{"chunk_excerpt":{"type":"boolean","title":"Chunk Excerpt","default":true},"embedding":{"type":"boolean","title":"Embedding","default":false}},"type":"object","title":"SearchInclude","description":"Options for what to include in search results."},"SearchRequest":{"properties":{"query":{"type":"string","maxLength":500,"minLength":1,"title":"Query"},"top_k":{"type":"integer","maximum":20.0,"minimum":1.0,"title":"Top K","default":10},"mode":{"type":"string","enum":["semantic","keyword","hybrid"],"title":"Mode","description":"Search mode: 'semantic' (vector similarity), 'keyword' (full-text), or 'hybrid' (combined)","default":"hybrid"},"rerank":{"type":"boolean","title":"Rerank","description":"Re-rank results using a cross-encoder model for improved relevance (requires reranker API key)","default":false},"dedupe":{"type":"boolean","title":"Dedupe","description":"Deduplicate results by article, showing only the best-matching chunk per article","default":true},"filters":{"$ref":"#/components/schemas/SearchFilters"},"group_by":{"anyOf":[{"type":"string","enum":["topic","author","year","section"]},{"type":"null"}],"title":"Group By"},"include":{"$ref":"#/components/schemas/SearchInclude"}},"type":"object","required":["query"],"title":"SearchRequest","description":"Search request body."},"StyleConfig":{"properties":{"format":{"type":"string","enum":["bullets","prose","numbered"],"title":"Format","default":"bullets"},"length":{"type":"string","enum":["short","medium","long"],"title":"Length","default":"short"}},"type":"object","title":"StyleConfig","description":"Style configuration for summaries."},"SummarizeRequest":{"properties":{"query":{"type":"string","maxLength":500,"minLength":1,"title":"Query"},"retrieval":{"$ref":"#/components/schemas/RetrievalConfig"},"style":{"$ref":"#/components/schemas/StyleConfig"}},"type":"object","required":["query"],"title":"SummarizeRequest","description":"Summarize request body."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}